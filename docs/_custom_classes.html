<!DOCTYPE html>
<html class="writer-html4" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Customising Classes &mdash; paya 0.2 documentation</title><link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html" class="icon icon-home"> paya
          </a>
              <div class="version">
                0.2
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="whats_new.html">What's New</a></li>
<li class="toctree-l1"><a class="reference internal" href="req_and_inst.html">Requirements &amp; Installation</a></li>
</ul>
<p class="caption"><span class="caption-text">Functionality</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="importing_and_patching.html">Importing and Patching</a></li>
<li class="toctree-l1"><a class="reference internal" href="using_the_runtime_interface.html">Using the Runtime Interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="naming_nodes.html">Naming Nodes</a></li>
<li class="toctree-l1"><a class="reference internal" href="maths_rigging.html">Maths Rigging</a></li>
<li class="toctree-l1"><a class="reference internal" href="discovering_func.html">Discovering Functionality</a></li>
</ul>
<p class="caption"><span class="caption-text">Customisation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="custom_classes.html">Customising Classes</a></li>
<li class="toctree-l1"><a class="reference internal" href="bracketing.html">Bracketing</a></li>
<li class="toctree-l1"><a class="reference internal" href="package_config.html">Package Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="sugar.html">Sugar</a></li>
</ul>
<p class="caption"><span class="caption-text">Appendices</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="paya.html">Module Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="implementation.html">Implementation</a></li>
<li class="toctree-l1"><a class="reference internal" href="author.html">Author</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">paya</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
      <li>Customising Classes</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/_custom_classes.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="section" id="customising-classes">
<h1>Customising Classes<a class="headerlink" href="#customising-classes" title="Permalink to this headline">¶</a></h1>
<div class="section" id="identifying-classes-to-target">
<h2>Identifying Classes to Target<a class="headerlink" href="#identifying-classes-to-target" title="Permalink to this headline">¶</a></h2>
<p>The first step in adding functionality to Paya objects is to identify the type (class) to target. To do this, it’s
useful to understand how it manages inheritance compared to PyMEL.</p>
<div class="section" id="pymel-inheritance">
<h3>PyMEL Inheritance<a class="headerlink" href="#pymel-inheritance" title="Permalink to this headline">¶</a></h3>
<p>PyMEL classes follow an inheritance stack broadly derived from the Maya API. To see this, make sure you’re running
PyMEL in ‘unpatched’ mode, and pass <code class="docutils literal notranslate"><span class="pre">inherited=True</span></code> to the standard <a class="reference external" href="https://help.autodesk.com/cloudhelp/2018/JPN/Maya-Tech-Docs/PyMel/generated/functions/pymel.core.general/pymel.core.general.nodeType.html#pymel.core.general.nodeType" title="(in PyMEL v1.0)"><code class="xref py py-func docutils literal notranslate"><span class="pre">nodeType()</span></code></a> command:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pymel.core</span> <span class="k">as</span> <span class="nn">p</span>
<span class="n">joint</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">joint</span><span class="p">()</span>
<span class="n">stack</span> <span class="o">=</span> <span class="n">joint</span><span class="o">.</span><span class="n">nodeType</span><span class="p">(</span><span class="n">inherited</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="c1"># Called as PyMEL method</span>
<span class="nb">print</span><span class="p">(</span><span class="n">stack</span><span class="p">)</span>
<span class="c1"># [&#39;containerBase&#39;, &#39;entity&#39;, &#39;dagNode&#39;, &#39;transform&#39;, &#39;joint&#39;]</span>

<span class="c1"># The following does the same:</span>
<span class="kn">import</span> <span class="nn">maya.cmds</span> <span class="k">as</span> <span class="nn">m</span>
<span class="n">joint</span> <span class="o">=</span> <span class="s1">&#39;joint1&#39;</span>
<span class="n">stack</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">nodeType</span><span class="p">(</span><span class="n">joint</span><span class="p">,</span> <span class="n">inherited</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">stack</span><span class="p">)</span>
</pre></div>
</div>
<p>In the returned list, the node’s most specific type (class) comes last, and its most general type comes first. In other
words, joints inherit functionality from transforms, which in turn inherit functionality from dagNodes, and
so on.</p>
<p>While some of these types, like <a class="reference external" href="https://help.autodesk.com/cloudhelp/2018/JPN/Maya-Tech-Docs/PyMel/generated/classes/pymel.core.nodetypes/pymel.core.nodetypes.Transform.html#pymel.core.nodetypes.Transform" title="(in PyMEL v1.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Transform</span></code></a>, can be created as Maya objects (e.g. groups),
others, like <a class="reference external" href="https://help.autodesk.com/cloudhelp/2018/JPN/Maya-Tech-Docs/PyMel/generated/classes/pymel.core.nodetypes/pymel.core.nodetypes.DagNode.html#pymel.core.nodetypes.DagNode" title="(in PyMEL v1.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">DagNode</span></code></a>, can’t. They are <a class="reference external" href="https://en.wikipedia.org/wiki/Abstract_type">abstract</a>,
existing only to define functionality that will be inherited.</p>
</div>
<div class="section" id="deeper-inspections">
<h3>Deeper Inspections<a class="headerlink" href="#deeper-inspections" title="Permalink to this headline">¶</a></h3>
<p><a class="reference external" href="https://help.autodesk.com/cloudhelp/2018/JPN/Maya-Tech-Docs/PyMel/generated/functions/pymel.core.general/pymel.core.general.nodeType.html#pymel.core.general.nodeType" title="(in PyMEL v1.0)"><code class="xref py py-func docutils literal notranslate"><span class="pre">nodeType()</span></code></a> returns a truncated list, and only works on nodes. For a more comprehensive
inspection of any PyMEL node, attribute, component or data instance, do the following:</p>
<blockquote>
<div><ol class="arabic simple">
<li>Get the PyMEL instance (don’t start with a string)</li>
<li>Get the class of the instance, either by calling <a class="reference external" href="https://docs.python.org/3/library/functions.html#type" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">type</span></code></a> on it, or via its <code class="docutils literal notranslate"><span class="pre">__class__</span></code> attribute</li>
<li>Get the <strong>method resolution order</strong> of the class via its <code class="docutils literal notranslate"><span class="pre">__mro__</span></code> attribute</li>
</ol>
</div></blockquote>
<p>Here’s an example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">joint</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">PyNode</span><span class="p">(</span><span class="s1">&#39;joint&#39;</span><span class="p">)</span> <span class="c1"># get a PyMEL instance</span>
<span class="bp">cls</span> <span class="o">=</span> <span class="n">joint</span><span class="o">.</span><span class="vm">__class__</span> <span class="c1"># or type(joint)</span>

<span class="nb">print</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__mro__</span><span class="p">)</span> <span class="c1"># get the inheritance stack</span>
<span class="c1"># (&lt;class &#39;pymel.core.nodetypes.Joint&#39;&gt;, &lt;class &#39;pymel.core.nodetypes.Transform&#39;&gt;, &lt;class &#39;pymel.core.nodetypes.DagNode&#39;&gt;, &lt;class &#39;pymel.core.nodetypes.Entity&#39;&gt;, &lt;class &#39;pymel.core.nodetypes.ContainerBase&#39;&gt;, &lt;class &#39;pymel.core.nodetypes.DependNode&#39;&gt;, &lt;class &#39;pymel.core.general.PyNode&#39;&gt;, &lt;class &#39;pymel.util.utilitytypes.proxyClass.&lt;locals&gt;.Proxy&#39;&gt;, &lt;class &#39;object&#39;&gt;)</span>

<span class="c1"># Also works with plug, component and data types:</span>

<span class="n">plug</span> <span class="o">=</span> <span class="n">joint</span><span class="o">.</span><span class="n">translate</span>
<span class="nb">print</span><span class="p">(</span><span class="n">plug</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__mro__</span><span class="p">)</span> <span class="c1"># or type(plug)</span>
<span class="c1"># (&lt;class &#39;pymel.core.general.Attribute&#39;&gt;, &lt;class &#39;pymel.core.general.PyNode&#39;&gt;, &lt;class &#39;pymel.util.utilitytypes.proxyClass.&lt;locals&gt;.Proxy&#39;&gt;, &lt;class &#39;object&#39;&gt;)</span>

<span class="n">mesh</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">PyNode</span><span class="p">(</span><span class="s1">&#39;pCube1&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">mesh</span><span class="o">.</span><span class="n">vtx</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__mro__</span><span class="p">)</span> <span class="c1"># or type(mesh.vtx[0])</span>
<span class="c1"># (&lt;class &#39;pymel.core.general.MeshVertex&#39;&gt;, &lt;class &#39;pymel.core.general.MItComponent1D&#39;&gt;, &lt;class &#39;pymel.core.general.MItComponent&#39;&gt;, &lt;class &#39;pymel.core.general.Component1D&#39;&gt;, &lt;class &#39;pymel.core.general.DiscreteComponent&#39;&gt;, &lt;class &#39;pymel.core.general.DimensionedComponent&#39;&gt;, &lt;class &#39;pymel.core.general.Component&#39;&gt;, &lt;class &#39;pymel.core.general.PyNode&#39;&gt;, &lt;class &#39;pymel.util.utilitytypes.proxyClass.&lt;locals&gt;.Proxy&#39;&gt;, &lt;class &#39;object&#39;&gt;)</span>

<span class="n">matrix</span> <span class="o">=</span> <span class="n">joint</span><span class="o">.</span><span class="n">worldMatrix</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">matrix</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__mro__</span><span class="p">)</span> <span class="c1"># or type(matrix)</span>
<span class="c1"># (&lt;class &#39;pymel.core.datatypes.Matrix&#39;&gt;, &lt;class &#39;pymel.util.arrays.MatrixN&#39;&gt;, &lt;class &#39;pymel.util.arrays.Array&#39;&gt;, &lt;class &#39;maya.OpenMaya.MMatrix&#39;&gt;, &lt;class &#39;object&#39;&gt;)</span>
</pre></div>
</div>
<p>Notice the following differences from <a class="reference external" href="https://help.autodesk.com/cloudhelp/2018/JPN/Maya-Tech-Docs/PyMel/generated/functions/pymel.core.general/pymel.core.general.nodeType.html#pymel.core.general.nodeType" title="(in PyMEL v1.0)"><code class="xref py py-func docutils literal notranslate"><span class="pre">nodeType()</span></code></a>:</p>
<ul class="simple">
<li>Instead of strings, actual Python classes are returned; these can be further inspected using <a class="reference external" href="https://docs.python.org/3/library/functions.html#help" title="(in Python v3.10)"><code class="xref py py-func docutils literal notranslate"><span class="pre">help()</span></code></a>,
<a class="reference external" href="https://docs.python.org/3/library/functions.html#dir" title="(in Python v3.10)"><code class="xref py py-func docutils literal notranslate"><span class="pre">dir()</span></code></a> or <a class="reference external" href="https://docs.python.org/3/library/inspect.html#module-inspect" title="(in Python v3.10)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">inspect</span></code></a></li>
<li>The order is reversed, with the most specific class on the left and the most generic one on the right</li>
<li>More ‘esoteric’ classes like <a class="reference external" href="https://help.autodesk.com/cloudhelp/2018/JPN/Maya-Tech-Docs/PyMel/generated/classes/pymel.core.nodetypes/pymel.core.nodetypes.DependNode.html#pymel.core.nodetypes.DependNode" title="(in PyMEL v1.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">DependNode</span></code></a> are now included, all the way up to the
most fundamental class in Python, <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a>.</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The <strong>method resolution order</strong> describes all the classes that Python will visit to find a method you’ve requested.
For example, when you call <a class="reference external" href="https://help.autodesk.com/cloudhelp/2018/JPN/Maya-Tech-Docs/PyMel/generated/classes/pymel.core.nodetypes/pymel.core.nodetypes.DagNode.html#pymel.core.nodetypes.DagNode.getParent" title="(in PyMEL v1.0)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">getParent()</span></code></a> on a joint instance, the method is not
retrieved from the <a class="reference external" href="https://help.autodesk.com/cloudhelp/2018/JPN/Maya-Tech-Docs/PyMel/generated/classes/pymel.core.nodetypes/pymel.core.nodetypes.Joint.html#pymel.core.nodetypes.Joint" title="(in PyMEL v1.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Joint</span></code></a> class; it’s actually defined inside
<a class="reference external" href="https://help.autodesk.com/cloudhelp/2018/JPN/Maya-Tech-Docs/PyMel/generated/classes/pymel.core.nodetypes/pymel.core.nodetypes.DagNode.html#pymel.core.nodetypes.DagNode" title="(in PyMEL v1.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">DagNode</span></code></a>, a class that other Maya DAG objects, like mesh shapes, also inherit from.</p>
</div>
</div>
<div class="section" id="the-paya-inheritance-stack">
<h3>The Paya Inheritance Stack<a class="headerlink" href="#the-paya-inheritance-stack" title="Permalink to this headline">¶</a></h3>
<p>When Paya patches PyMEL at runtime, it inserts a custom descendant for every PyMEL class into the inheritance stack,
resulting in a ‘doubled’ method resolution order:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pymel.core</span> <span class="k">as</span> <span class="nn">p</span>
<span class="kn">import</span> <span class="nn">paya.runtime</span>
<span class="c1"># PyMEL has been patched successfully.</span>

<span class="n">joint</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">PyNode</span><span class="p">(</span><span class="s1">&#39;joint1&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">joint</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__mro__</span><span class="p">)</span>
<span class="c1"># (&lt;class &#39;paya.nodetypes.joint.Joint&#39;&gt;, &lt;class &#39;pymel.core.nodetypes.Joint&#39;&gt;, &lt;class &#39;paya.nodetypes.transform.Transform&#39;&gt;, &lt;class &#39;pymel.core.nodetypes.Transform&#39;&gt;, &lt;class &#39;paya.nodetypes.dagNode.DagNode&#39;&gt;, &lt;class &#39;pymel.core.nodetypes.DagNode&#39;&gt;, &lt;class &#39;paya.nodetypes.entity.Entity&#39;&gt;, &lt;class &#39;pymel.core.nodetypes.Entity&#39;&gt;, &lt;class &#39;paya.nodetypes.containerBase.ContainerBase&#39;&gt;, &lt;class &#39;pymel.core.nodetypes.ContainerBase&#39;&gt;, &lt;class &#39;paya.nodetypes.dependNode.DependNode&#39;&gt;, &lt;class &#39;pymel.core.nodetypes.DependNode&#39;&gt;, &lt;class &#39;pymel.core.general.PyNode&#39;&gt;, &lt;class &#39;pymel.util.utilitytypes.proxyClass.&lt;locals&gt;.Proxy&#39;&gt;, &lt;class &#39;object&#39;&gt;)</span>
</pre></div>
</div>
<p>This approach overcomes the limitations of PyMEL’s
<a class="reference external" href="https://github.com/LumaPictures/pymel/blob/master/examples/customClasses.py">virtual classes</a> system in the following
ways:</p>
<blockquote>
<div><ul class="simple">
<li>PyMEL classes themselves inherit from Paya classes, so that any added methods will trickle down properly</li>
<li>Many more classes can be targeted for customisation, including components, attribute, data and abstract types</li>
</ul>
</div></blockquote>
</div>
<div class="section" id="attribute-subtypes">
<h3>Attribute Subtypes<a class="headerlink" href="#attribute-subtypes" title="Permalink to this headline">¶</a></h3>
<p>PyMEL provides just one class for attributes: <a class="reference external" href="https://help.autodesk.com/cloudhelp/2018/JPN/Maya-Tech-Docs/PyMel/generated/classes/pymel.core.general/pymel.core.general.Attribute.html#pymel.core.general.Attribute" title="(in PyMEL v1.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Attribute</span></code></a>. Paya splits this into more
subtypes using an abstract inheritance tree, itself broadly derived from the Maya API.</p>
</div>
</div>
</div>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, Kimon Matara.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>