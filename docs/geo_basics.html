<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Geometry Basics &mdash; paya 0.8.2 documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="_static/tabs.css" type="text/css" />
      <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/tabs.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="NURBS &amp; Bezier Curves" href="curves.html" />
    <link rel="prev" title="Geometry" href="geometry.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html">
            <img src="_static/logo_sidebar.png" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                0.8.2
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="whats_new.html">What's New</a></li>
<li class="toctree-l1"><a class="reference internal" href="getting_started.html">Getting Started</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Rigging</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="maths_rigging.html">Maths</a></li>
<li class="toctree-l1"><a class="reference internal" href="joint_chains.html">Joint Chains</a></li>
<li class="toctree-l1"><a class="reference internal" href="ik.html">IK Handles</a></li>
<li class="toctree-l1"><a class="reference internal" href="deformers.html">Deformers</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="geometry.html">Geometry</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">Basics</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#sampling">Sampling</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#sampling-methods-on-shapes">Sampling Methods on Shapes</a></li>
<li class="toctree-l4"><a class="reference internal" href="#sampling-methods-on-plugs">Sampling Methods on Plugs</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#editing">Editing</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#editing-methods-on-shapes">Editing Methods on Shapes</a></li>
<li class="toctree-l4"><a class="reference internal" href="#editing-methods-on-plugs">Editing Methods on Plugs</a></li>
<li class="toctree-l4"><a class="reference internal" href="#transforming-geometry-in-the-dependency-graph">Transforming Geometry in the Dependency Graph</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#component-methods">Component Methods</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="curves.html">NURBS and Bezier Curves</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="controls.html">Controls</a></li>
<li class="toctree-l1"><a class="reference internal" href="user_attrs.html">User Attributes</a></li>
<li class="toctree-l1"><a class="reference internal" href="naming_nodes.html">Node Names</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Customisation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="adding_oo_functionality.html">Adding Your Own Methods</a></li>
<li class="toctree-l1"><a class="reference internal" href="package_config.html">Package Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="sugar_and_style.html">Sugar and Style</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Appendices</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="types_index.html">Types</a></li>
<li class="toctree-l1"><a class="reference internal" href="paya.html">Modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="implementation.html">Implementation</a></li>
<li class="toctree-l1"><a class="reference internal" href="glossary.html">Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="licence.html">MIT License</a></li>
<li class="toctree-l1"><a class="reference internal" href="author.html">Author</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">paya</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="geometry.html">Geometry</a> &raquo;</li>
      <li>Geometry Basics</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/geo_basics.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="geometry-basics">
<h1>Geometry Basics<a class="headerlink" href="#geometry-basics" title="Permalink to this headline"></a></h1>
<p>Paya methods for geometry editing and sampling can be found on shape, attribute and component instances. As at
<strong>version 0.8</strong>, NURBS and Bezier curves are best-represented, with more to follow.</p>
<section id="sampling">
<h2>Sampling<a class="headerlink" href="#sampling" title="Permalink to this headline"></a></h2>
<p>Geometry <em>sampling</em> refers to the extraction of geometry characteristics such as point positions, normals and so on.
This information can be obtained <em>statically</em> (i.e. read once as values) or <em>dynamically</em> (i.e. as constantly-updating
attributes that can be plugged into rigs).</p>
<section id="sampling-methods-on-shapes">
<h3>Sampling Methods on Shapes<a class="headerlink" href="#sampling-methods-on-shapes" title="Permalink to this headline"></a></h3>
<p>When a sampling method is called on a shape, by default it will return values. If the method accepts a <em>plug</em>/<em>p</em>
argument, this can be used to request a dynamic output instead. In addition, many sampling methods on shapes will
default to dynamic output if they receive attributes are arguments.</p>
<p>For example, here are a few ways to use <a class="reference internal" href="pools/nodes/nurbsCurve.html#paya.runtime.nodes.NurbsCurve.pointAtParam" title="paya.runtime.nodes.NurbsCurve.pointAtParam"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pointAtParam()</span></code></a> on
<a class="reference internal" href="pools/nodes/nurbsCurve.html#paya.runtime.nodes.NurbsCurve" title="paya.runtime.nodes.NurbsCurve"><code class="xref py py-class docutils literal notranslate"><span class="pre">NurbsCurve</span></code></a>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">curve</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">PyNode</span><span class="p">(</span><span class="s1">&#39;curve1&#39;</span><span class="p">)</span>

<span class="c1"># Static</span>
<span class="n">point</span> <span class="o">=</span> <span class="n">curve</span><span class="o">.</span><span class="n">pointAtParam</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">point</span><span class="p">)</span>
<span class="c1"># [-1.304898110589346, 0.0, 2.7682413933789762] (Point instance)</span>

<span class="c1"># Dynamic</span>
<span class="n">point</span> <span class="o">=</span> <span class="n">curve</span><span class="o">.</span><span class="n">pointAtParam</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">plug</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">point</span><span class="p">)</span>
<span class="c1"># NPCI.position (pointOnCurveInfo output)</span>

<span class="c1"># Implicitly dynamic, as parameter was specified using</span>
<span class="c1"># an attribute</span>
<span class="n">parameter</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">PyNode</span><span class="p">(</span><span class="s1">&#39;settings_CTRL&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">attr</span><span class="p">(</span><span class="s1">&#39;paramToSample&#39;</span><span class="p">)</span>
<span class="n">point</span> <span class="o">=</span> <span class="n">curve</span><span class="o">.</span><span class="n">pointAtParam</span><span class="p">(</span><span class="n">parameter</span><span class="p">)</span>
<span class="c1"># NPCI.position (pointOnCurveInfo output)</span>
</pre></div>
</div>
</section>
<section id="sampling-methods-on-plugs">
<h3>Sampling Methods on Plugs<a class="headerlink" href="#sampling-methods-on-plugs" title="Permalink to this headline"></a></h3>
<p>Sampling methods can also be called on geometry output plugs. If the plug is on a shape, it’s important to check it’s
the right one. Maya shapes typically include both local- and world-space outputs, and these aren’t consistently named.
For example, on a curve there is <code class="docutils literal notranslate"><span class="pre">local</span></code> and <code class="docutils literal notranslate"><span class="pre">worldSpace</span></code>, whereas on a mesh the equivalent plugs are <code class="docutils literal notranslate"><span class="pre">outMesh</span></code>
and <code class="docutils literal notranslate"><span class="pre">worldMesh</span></code>.</p>
<p>To make things easier, Paya implements <code class="docutils literal notranslate"><span class="pre">geoInput</span></code>, <code class="docutils literal notranslate"><span class="pre">localGeoOutput</span></code> and <code class="docutils literal notranslate"><span class="pre">worldGeoOutput</span></code> properties on all
geometry shape instances:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">curve</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">PyNode</span><span class="p">(</span><span class="s1">&#39;curve1&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">curve</span><span class="o">.</span><span class="n">localGeoOutput</span><span class="p">)</span>
<span class="c1"># curveShape1.worldSpace</span>
</pre></div>
</div>
<p>When a sampling method is called on an output plug, it will <em>always</em> be dynamic, unless otherwise noted in the docs:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">point</span> <span class="o">=</span> <span class="n">curve</span><span class="o">.</span><span class="n">worldGeoOutput</span><span class="o">.</span><span class="n">pointAtParam</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">point</span><span class="p">)</span>
<span class="c1"># NPCI.position (pointOnCurveInfo output)</span>
</pre></div>
</div>
</section>
</section>
<section id="editing">
<h2>Editing<a class="headerlink" href="#editing" title="Permalink to this headline"></a></h2>
<section id="editing-methods-on-shapes">
<h3>Editing Methods on Shapes<a class="headerlink" href="#editing-methods-on-shapes" title="Permalink to this headline"></a></h3>
<p>Geometry-editing methods on shapes work similarly to Maya’s commands, with the exception that the global
<em>constructionHistory</em> preference is always overriden to <code class="docutils literal notranslate"><span class="pre">True</span></code>. This is to prevent a stray <code class="docutils literal notranslate"><span class="pre">False</span></code> preference from
tanking scripted rig builds. History can always be deleted afterwards using the
<a class="reference internal" href="pools/nodes/deformableShape.html#paya.runtime.nodes.DeformableShape.deleteHistory" title="paya.runtime.nodes.DeformableShape.deleteHistory"><code class="xref py py-meth docutils literal notranslate"><span class="pre">deleteHistory()</span></code></a> method:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">segments</span> <span class="o">=</span> <span class="n">curve</span><span class="o">.</span><span class="n">detach</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">segments</span><span class="p">)</span>
<span class="c1"># [nt.NurbsCurve(&#39;curveShape1&#39;), nt.NurbsCurve(&#39;NCRVShape&#39;)]</span>

<span class="k">for</span> <span class="n">segment</span> <span class="ow">in</span> <span class="n">segments</span><span class="p">:</span>
    <span class="n">segment</span><span class="o">.</span><span class="n">deleteHistory</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="editing-methods-on-plugs">
<span id="procedural-geo-editing"></span><h3>Editing Methods on Plugs<a class="headerlink" href="#editing-methods-on-plugs" title="Permalink to this headline"></a></h3>
<p>Working with plugs allows you to build complex editing networks in the dependency graph before connecting to an output
shape. This gives you more control, and cuts down on shape clutter, but takes slightly more housekeeping. A typical
workflow is to:</p>
<ol class="arabic simple">
<li><p>Use <a class="reference internal" href="pools/nodes/deformableShape.html#paya.runtime.nodes.DeformableShape.getHistoryPlug" title="paya.runtime.nodes.DeformableShape.getHistoryPlug"><code class="xref py py-meth docutils literal notranslate"><span class="pre">getHistoryPlug(create=True)</span></code></a> to get a geometry
stream ‘before’ the hero shape, so that you don’t work on its outputs directly</p></li>
<li><p>Chain-up some operations</p></li>
<li><p>Connect back into the input on the hero shape (if you’re unsure of the right attribute just use Paya’s <code class="docutils literal notranslate"><span class="pre">geoInput</span></code>
property).</p></li>
</ol>
<p>In the following example, a clustered linear curve is converted to a cubic curve and chipped off:</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-0-0-0" aria-selected="true" class="sphinx-tabs-tab" id="tab-0-0-0" name="0-0" role="tab" tabindex="0">Viewport</button><button aria-controls="panel-0-0-1" aria-selected="false" class="sphinx-tabs-tab" id="tab-0-0-1" name="0-1" role="tab" tabindex="-1">Paya</button></div><div aria-labelledby="tab-0-0-0" class="sphinx-tabs-panel" id="panel-0-0-0" name="0-0" role="tabpanel" tabindex="0"><figure class="align-center">
<img alt="_images/plug_geo_editing.gif" src="_images/plug_geo_editing.gif" />
</figure>
</div><div aria-labelledby="tab-0-0-1" class="sphinx-tabs-panel" hidden="true" id="panel-0-0-1" name="0-1" role="tabpanel" tabindex="0"><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">curve</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">PyNode</span><span class="p">(</span><span class="s1">&#39;main_NCRV&#39;</span><span class="p">)</span>
<span class="n">stream</span> <span class="o">=</span> <span class="n">curve</span><span class="o">.</span><span class="n">getHistoryPlug</span><span class="p">(</span><span class="n">create</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">stream</span> <span class="o">=</span> <span class="n">stream</span><span class="o">.</span><span class="n">bSpline</span><span class="p">()</span>
<span class="n">stream</span> <span class="o">=</span> <span class="n">stream</span><span class="o">.</span><span class="n">detach</span><span class="p">(</span><span class="mf">0.3</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="n">select</span><span class="o">=</span><span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">stream</span> <span class="o">&gt;&gt;</span> <span class="n">curve</span><span class="o">.</span><span class="n">geoInput</span>
</pre></div>
</div>
</div></div>
<p>It won’t always be possible to plug into an existing shape; for example, when an edit operation yields an incompatible
geometry type or multiple outputs. In such cases, you can use <a class="reference internal" href="pools/plugs/geometry.html#paya.runtime.plugs.Geometry.createShape" title="paya.runtime.plugs.Geometry.createShape"><code class="xref py py-meth docutils literal notranslate"><span class="pre">createShape()</span></code></a> to
create new shapes.</p>
<p>In the following variant of the previous example, the bottom segment is ‘rendered’ as an added scene curve:</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-1-1-0" aria-selected="true" class="sphinx-tabs-tab" id="tab-1-1-0" name="1-0" role="tab" tabindex="0">Viewport &amp; Outliner</button><button aria-controls="panel-1-1-1" aria-selected="false" class="sphinx-tabs-tab" id="tab-1-1-1" name="1-1" role="tab" tabindex="-1">Paya</button></div><div aria-labelledby="tab-1-1-0" class="sphinx-tabs-panel" id="panel-1-1-0" name="1-0" role="tabpanel" tabindex="0"><figure class="align-center">
<img alt="_images/multiple_outputs.gif" src="_images/multiple_outputs.gif" />
</figure>
</div><div aria-labelledby="tab-1-1-1" class="sphinx-tabs-panel" hidden="true" id="panel-1-1-1" name="1-1" role="tabpanel" tabindex="0"><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">curve</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">PyNode</span><span class="p">(</span><span class="s1">&#39;main_NCRV&#39;</span><span class="p">)</span>
<span class="n">stream</span> <span class="o">=</span> <span class="n">curve</span><span class="o">.</span><span class="n">getHistoryPlug</span><span class="p">(</span><span class="n">create</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">stream</span> <span class="o">=</span> <span class="n">stream</span><span class="o">.</span><span class="n">bSpline</span><span class="p">()</span>
<span class="n">segments</span> <span class="o">=</span> <span class="n">stream</span><span class="o">.</span><span class="n">detach</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.3</span><span class="p">,</span> <span class="n">select</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="n">segments</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;&gt;</span> <span class="n">curve</span><span class="o">.</span><span class="n">geoInput</span>
<span class="n">segments</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">createShape</span><span class="p">()</span>
</pre></div>
</div>
</div></div>
</section>
<section id="transforming-geometry-in-the-dependency-graph">
<h3>Transforming Geometry in the Dependency Graph<a class="headerlink" href="#transforming-geometry-in-the-dependency-graph" title="Permalink to this headline"></a></h3>
<p>The <a class="reference internal" href="pools/plugs/geometry.html#paya.runtime.plugs.Geometry.transform" title="paya.runtime.plugs.Geometry.transform"><code class="xref py py-meth docutils literal notranslate"><span class="pre">transform()</span></code></a> method on <a class="reference internal" href="pools/plugs/geometry.html#paya.runtime.plugs.Geometry" title="paya.runtime.plugs.Geometry"><code class="xref py py-class docutils literal notranslate"><span class="pre">Geometry</span></code></a> pairs well with
matrix operators to enable complex transformations of geometry at the plug level, for example to apply thickness scaling
to the <code class="docutils literal notranslate"><span class="pre">wrap</span></code> and <code class="docutils literal notranslate"><span class="pre">proximityWrap</span></code> deformers.</p>
</section>
</section>
<section id="component-methods">
<h2>Component Methods<a class="headerlink" href="#component-methods" title="Permalink to this headline"></a></h2>
<p>Many sampling and editing methods are also available on components, typically with more concise names. Call <a class="reference external" href="https://docs.python.org/3/library/functions.html#help" title="(in Python v3.10)"><code class="xref py py-func docutils literal notranslate"><span class="pre">help()</span></code></a>
on a component instance of interest to see what methods are available. Here’s a variant of
<a class="reference internal" href="pools/nodes/nurbsCurve.html#paya.runtime.nodes.NurbsCurve.pointAtParam" title="paya.runtime.nodes.NurbsCurve.pointAtParam"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pointAtParam()</span></code></a> on <a class="reference internal" href="pools/comps/nurbsCurveParameter.html#paya.runtime.comps.NurbsCurveParameter" title="paya.runtime.comps.NurbsCurveParameter"><code class="xref py py-class docutils literal notranslate"><span class="pre">NurbsCurveParameter</span></code></a>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">curve</span><span class="o">.</span><span class="n">u</span><span class="p">[</span><span class="mf">0.5</span><span class="p">]</span><span class="o">.</span><span class="n">point</span><span class="p">(</span><span class="n">plug</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="c1"># NPCI.position (pointOnCurveInfo output)</span>
</pre></div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="geometry.html" class="btn btn-neutral float-left" title="Geometry" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="curves.html" class="btn btn-neutral float-right" title="NURBS &amp; Bezier Curves" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, Kimon Matara.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>